(window.webpackJsonp=window.webpackJsonp||[]).push([[60],{1192:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var a=n(2168),o=Object(a.a)({scriptUrl:"https://at.alicdn.com/t/c/font_914650_ub310hoi1k.js"})},1470:function(e,t,n){"use strict";(function(e){n.d(t,"b",(function(){return p})),n.d(t,"a",(function(){return d})),n.d(t,"e",(function(){return m})),n.d(t,"d",(function(){return _})),n.d(t,"c",(function(){return f}));n(65);var a=n(22),o=n.n(a),r=n(31),c=n(2),i=n(47),s=n(1),l=n.n(s),u=r.a.t,p=function(e,t){var n=document.createElement("span"),a=n.offsetHeight;return n.style.visibility="hidden",n.style.fontSize="12px",n.style.width="".concat(window.innerWidth-t,"px"),n.style.lineHeight="17px",n.style.display="inline-block",document.body.appendChild(n),"undefined"!==typeof n.textContent?n.textContent=e:n.innerText=e,a=parseFloat(window.getComputedStyle(n).height)-a,n.parentNode.removeChild(n),a},d=function(e){return"".concat(c.d,"/cloud/file/avatar/").concat(e)},m=function(e){return"5"===e||"7"===e||"8"===e},_=function(e){return"2"===e||"3"===e||"4"===e},f=function(t,n,a,r,c){return Object(i.d)(Object(i.b)(t))?Object(i.c)(t).length<r&&"1"===c?(o.a.fail(u("mooc_discuss:utils.judge_point_can_send.info2",{type:n,word_min:r})),!1):!(e.point_time&&b(e.point_time,l()())<a)||(o.a.fail(u("mooc_discuss:utils.judge_point_can_send.info1",{type:n,interval_second:a})),!1):(o.a.fail(u("mooc_discuss:utils.judge_point_can_send.info3",{type:n})),!1)},b=function(e,t){return l()(t).diff(l()(e),"second")}}).call(this,n(53))},1829:function(e,t,n){"use strict";n(1267);var a=n(1268),o=n.n(a),r=n(12),c=n.n(r),i=n(25),s=n.n(i),l=n(29),u=n.n(l),p=n(1256),d=n.n(p),m=n(75),_=n.n(m),f=n(3),b=n.n(f),v=n(31),y=n(1192),h=n(13),E=n.n(h),g=n(2);function k(e){return(k="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function w(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function S(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,O(a.key),a)}}function O(e){var t=function(e,t){if("object"!=k(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var a=n.call(e,t||"default");if("object"!=k(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==k(t)?t:t+""}function j(e,t,n){return t=C(t),function(e,t){if(t&&("object"===k(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}()?Reflect.construct(t,n||[],C(e).constructor):t.apply(e,n))}function C(e){return(C=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function P(e,t){return(P=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}v.a.t;var x=function(e){function t(){var e;w(this,t);for(var n=arguments.length,a=new Array(n),o=0;o<n;o++)a[o]=arguments[o];return(e=j(this,t,[].concat(a))).state={selected_channel:"",channelList:[],showFilter:!1},e.getChannelData=function(){var t=e.props,n=t.node_id,a=t.group_id;t.isSubgroup?Object(g.i)("".concat(g.f,"/resource/queryResource"),{node_id:n}).then((function(t){var n=t.data;if(t.success){var a=n.discussion_task_assign,o=void 0===a?[]:a,r=e.getChannelPickerData(o);e.setState({channelList:r,showFilter:!u()(o)})}})):Object(g.i)("".concat(g.f,"/group/class/list/").concat(a)).then((function(t){var n=t.data;if(t.success){var a=e.getClassPickerData(n);e.setState({channelList:a,showFilter:!u()(n)})}}))},e.getChannelPickerData=function(e){var t=[{label:"\u5168\u90e8",name:"\u5168\u90e8",value:""}];return s()(e,(function(e){t.push({label:e.subgroup_name.length>20?e.subgroup_name.slice(0,20)+"...":e.subgroup_name,name:e.subgroup_name,value:e.subgroup_id})})),t},e.getClassPickerData=function(e){var t=[{label:"\u5168\u90e8",name:"\u5168\u90e8",value:""}];return s()(e,(function(e){t.push({label:e.class_name.length>20?e.class_name.slice(0,20)+"...":e.class_name,name:e.class_name,value:e.class_id})})),t},e.handleSelectChannel=function(t){var n=e.props.onSelectChannel;e.setState({selected_channel:t[0]},(function(){n&&n(t[0])}))},e}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&P(e,t)}(t,e),n=t,r=[{key:"getDerivedStateFromProps",value:function(e,t){return d()(t.selected_channel,e.channel)?null:{selected_channel:e.channel}}}],(a=[{key:"componentDidMount",value:function(){this.getChannelData()}},{key:"render",value:function(){var e,t,n=this.state,a=n.channelList,r=n.selected_channel,i=n.showFilter;if(u()(a)||!i)return null;var s=null!==(e=null===(t=c()(a,{value:r}))||void 0===t?void 0:t.name)&&void 0!==e?e:"";return b.a.createElement(o.a,{cols:1,title:"\u7b5b\u9009",data:a,value:[r],onChange:this.handleSelectChannel},b.a.createElement("div",{className:_()("discuss_channel_filter")},b.a.createElement("span",{className:_()("filter_name")},s),b.a.createElement(y.a,{type:"icon-down1"})))}}])&&S(n.prototype,a),r&&S(n,r),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,a,r}(b.a.Component);x.propTypes={node_id:E.a.string,group_id:E.a.string,isSubgroup:E.a.bool,onSelectChannel:E.a.func},x.defaultProps={node_id:"",group_id:"",isSubgroup:!1,onSelectChannel:function(){}},t.a=x},2042:function(e,t,n){e.exports=n.p+"d0e11bf3dd459e57881378b98fa25a05.png"},2043:function(e,t,n){e.exports=n.p+"dc45d69d644da036773d41e3ee6852a0.png"},2044:function(e,t,n){e.exports=n.p+"926edffab8fda673a0bb9c039994f8ba.png"},2045:function(e,t,n){e.exports=n.p+"160331ccce3fb3c3f16dc7d6a070bb2d.png"},2046:function(e,t,n){e.exports=n.p+"159a22829be63c212f870db3f8052ccb.png"},2047:function(e,t,n){e.exports=n.p+"48ba5ac13970d0647091c2de6fe26f46.png"},2048:function(e,t,n){e.exports=n.p+"cfb07d8e0f53b3fdbd5e4f8330c845d2.png"},2158:function(e,t,n){"use strict";n.r(t);n(1260);var a,o=n(1261),r=n.n(o),c=(n(1262),n(342)),i=n.n(c),s=(n(1336),n(1337)),l=n.n(s),u=n(67),p=n.n(u),d=n(1342),m=n.n(d),_=n(75),f=n.n(_),b=n(3),v=n.n(b),y=n(137),h=n(185),E=n(19),g=n(8),k=n(1192),w=n(1829),S=n(1470),O=n(31),j=n(2042),C=n.n(j),P=n(2043),x=n.n(P),D=n(2044),N=n.n(D),R=n(2045),T=n.n(R),B=n(2046),F=n.n(B),L=n(2047),q=n.n(L),G=n(2048),M=n.n(G);function W(e){return(W="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function H(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,J(a.key),a)}}function J(e){var t=function(e,t){if("object"!=W(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var a=n.call(e,t||"default");if("object"!=W(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==W(t)?t:t+""}function z(e,t,n){return t=A(t),function(e,t){if(t&&("object"===W(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}()?Reflect.construct(t,n||[],A(e).constructor):t.apply(e,n))}function A(e){return(A=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function I(e,t){return(I=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var U=O.a.t,V=l.a.Item,K=Object(h.c)((function(e,t){var n=t.match.params.node_id;return{discussionBasicData:Object(E.c)(e),discussionStat:Object(E.e)(e),task:Object(E.f)(e,n)}}),(function(e){return{discussDispatcher:Object(y.b)(g.a,e)}}))(a=function(e){function t(e){var n,a;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(a=z(this,t,[e])).getData=function(){var e,t,n,o=a.props.match.params,r=o.group_id,c=o.node_id,i=o.quote_id,s=o.subgroup_id,l=a.state,u=l.sort_way,p=l.sort_type;a.props.discussDispatcher.getDiscussionStat(r,i,c,s,1,9999,(e={},n=u,(t=J(t=p))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e),p,a.getChannel())},a.getChannel=function(){var e,t=m.a.parse(a.props.location.search).role,n=a.props.discussionBasicData,o=a.state.channel;return 1==t?1===(null===n||void 0===n?void 0:n.discussion_channel_type)&&null!==(e=null===n||void 0===n?void 0:n.channel)&&void 0!==e?e:"":o},a.handleGoBack=function(){var e=a.props.match.params,t=e.group_id,n=e.node_id,o=e.quote_id,r=e.subgroup_id;r?a.props.history.push("/paper_mobile/mooc/discuss/".concat(t,"/").concat(n,"/").concat(o,"/").concat(r)+a.props.location.search):a.props.history.push("/paper_mobile/mooc/discuss/".concat(t,"/").concat(n,"/").concat(o)+a.props.location.search)},a.handleRefresh=function(){a.getData()},a.handleOrderChange=function(){var e=a.state.sort_way;a.setState({sort_way:"desc"===e?"asc":"desc"})},a.handleSelectChannel=function(e){a.setState({channel:e,showWordCloud:!1},(function(){a.handleRefresh()}))},a.handleGoPointRecord=function(e,t,n){var o=a.props.match.params,r=o.group_id,c=o.node_id,i=o.quote_id,s=o.subgroup_id,l=m.a.parse(a.props.location.search),u=l.role,p=l.user_id;n.stopPropagation(),s?a.props.history.push("/paper_mobile/mooc/point_record/".concat(r,"/").concat(c,"/").concat(i,"/").concat(s,"?creator_id=").concat(e,"&role=").concat(u,"&user_id=").concat(p,"&nickname=").concat(t)):a.props.history.push("/paper_mobile/mooc/point_record/".concat(r,"/").concat(c,"/").concat(i,"?creator_id=").concat(e,"&role=").concat(u,"&user_id=").concat(p,"&nickname=").concat(t))},a.renderMyCount=function(){var e=a.props.match.params.subgroup_id,t=a.props.discussionStat,n=t.my_liked,o=t.my_points,r=t.my_comment_point,c=t.my_comment_reply,s=t.my_to_like,u=t.my_best_point,p=t.my_invalid_point;return v.a.createElement("div",{className:f()("my-count")},v.a.createElement("div",null,v.a.createElement("span",null,U("mooc_discuss:statistics.render_my_count.my_count.div")),v.a.createElement(l.a,{overlay:v.a.createElement("div",{style:{padding:8,backgroundColor:"black",color:"white"}},"\u4e3b\u5e16\u3001\u56de\u5e16\u3001\u56de\u590d\u7b97\u4f5c\u53c2\u4e0e\u5e76\u5b8c\u6210\u8ba8\u8bba\u4efb\u52a1"),placement:"left"},v.a.createElement(i.a,{type:"info-circle-o",className:f()("remind_tip",{hide:!!e})}))),v.a.createElement("div",null,v.a.createElement("div",{className:f()("circle")},v.a.createElement("img",{src:C.a}),v.a.createElement("span",null,o)),v.a.createElement("div",{className:f()("circle")},v.a.createElement("img",{src:x.a}),v.a.createElement("span",null,r)),v.a.createElement("div",{className:f()("circle")},v.a.createElement("img",{src:N.a}),v.a.createElement("span",null,c)),v.a.createElement("div",{className:f()("circle")},v.a.createElement("img",{src:T.a}),v.a.createElement("span",null,s)),v.a.createElement("div",{className:f()("circle")},v.a.createElement("img",{src:F.a}),v.a.createElement("span",null,n)),v.a.createElement("div",{className:f()("circle")},v.a.createElement("img",{src:q.a}),v.a.createElement("span",null,u)),v.a.createElement("div",{className:f()("circle")},v.a.createElement("img",{src:M.a}),v.a.createElement("span",null,p))))},a.renderRank=function(){var e=a.props,t=e.discussionStat,n=t.total_member,o=t.total_point,r=t.total_comment_point,c=t.total_comment_reply,i=t.total_best_point,s=t.total_invalid_point,l=e.discussionBasicData.open_anonymous_mode;return v.a.createElement("div",{className:f()("rank")},v.a.createElement("div",null,v.a.createElement("div",null,U("mooc_discuss:statistics.render_rank.rank")),!l&&a.renderSortBtn()),v.a.createElement("div",null,v.a.createElement("div",null,v.a.createElement("span",null,U("mooc_discuss:statistics.render_rank.total_point")," "),v.a.createElement("span",null,null!==o&&void 0!==o?o:0)),v.a.createElement("div",null,v.a.createElement("span",null,U("mooc_discuss:statistics.render_rank.total_comment_point")," "),v.a.createElement("span",null,null!==r&&void 0!==r?r:0)),v.a.createElement("div",null,v.a.createElement("span",null,U("mooc_discuss:statistics.render_rank.total_comment_reply")," "),v.a.createElement("span",null,null!==c&&void 0!==c?c:0)),v.a.createElement("div",null,v.a.createElement("span",null,U("mooc_discuss:statistics.render_rank.total_member")," "),v.a.createElement("span",null,null!==n&&void 0!==n?n:0)),v.a.createElement("div",null,v.a.createElement("span",null,U("mooc_discuss:statistics.render_rank.total_best_point")," "),v.a.createElement("span",null,null!==i&&void 0!==i?i:0)),v.a.createElement("div",null,v.a.createElement("span",null,U("mooc_discuss:statistics.render_rank.total_invalid_point")," "),v.a.createElement("span",null,null!==s&&void 0!==s?s:0))))},a.renderTable=function(){var e=a.props,t=e.discussionStat.member_info,n=void 0===t?[]:t,o=e.discussionBasicData.open_anonymous_mode,r=a.state,c=r.sort_way,i=r.sort_type,s=p()(n,i,c);return v.a.createElement("div",{className:f()("table",{hide:o})},s.map((function(e,t){var n=e.nick_name,o=e.point_count,r=e.comment_point_count,c=e.comment_reply_count,i=e.to_like_count,s=e.liked_count,l=e.best_point_count,u=e.invalid_point_count,p=e.user_id,d=e.ranking;return v.a.createElement("div",{key:t,className:f()("cell_content")},v.a.createElement("div",null,v.a.createElement("div",{className:f()("six")},d),v.a.createElement("img",{src:Object(S.a)(p)}),v.a.createElement("span",{onClick:a.handleGoPointRecord.bind(a,p,n)},n)),v.a.createElement("div",null,v.a.createElement("div",null,v.a.createElement("span",null,U("mooc_discuss:statistics.render_table.cell_content.point_count")),v.a.createElement("span",null,o)),v.a.createElement("div",null,v.a.createElement("span",null,U("mooc_discuss:statistics.render_table.cell_content.comment_point_count")),v.a.createElement("span",null,r)),v.a.createElement("div",null,v.a.createElement("span",null,U("mooc_discuss:statistics.render_table.cell_content.comment_reply_count")),v.a.createElement("span",null,c)),v.a.createElement("div",null,v.a.createElement("span",null,U("mooc_discuss:statistics.render_table.cell_content.to_like_count")),v.a.createElement("span",null,i)),v.a.createElement("div",null,v.a.createElement("span",null,U("mooc_discuss:statistics.render_table.cell_content.liked_count")),v.a.createElement("span",null,s)),v.a.createElement("div",null,v.a.createElement("span",null,U("mooc_discuss:statistics.render_table.cell_content.best_point_count")),v.a.createElement("span",null,l)),v.a.createElement("div",null,v.a.createElement("span",null,U("mooc_discuss:statistics.render_table.cell_content.invalid_point_count")),v.a.createElement("span",null,u))))})))},a.renderSortBtn=function(){var e=U("mooc_discuss:statistics.state.curr_text.default"),t="";return v.a.createElement("div",{className:f()("sort")},v.a.createElement("div",{onClick:a.handleOrderChange},v.a.createElement(i.a,{type:"desc"===a.state.sort_way?"arrow-down":"arrow-up"})),v.a.createElement(l.a,{overlay:[v.a.createElement(V,{key:"1",value:"point"},U("mooc_discuss:statistics.render_sort_btn.popover.overlay.point")),v.a.createElement(V,{key:"2",value:"common"},U("mooc_discuss:statistics.render_sort_btn.popover.overlay.common")),v.a.createElement(V,{key:"3",value:"reply"},U("mooc_discuss:statistics.render_sort_btn.popover.overlay.reply")),v.a.createElement(V,{key:"4",value:"like"},U("mooc_discuss:statistics.render_sort_btn.popover.overlay.like")),v.a.createElement(V,{key:"5",value:"tolike"},U("mooc_discuss:statistics.render_sort_btn.popover.overlay.to_like"))],placement:"bottomLeft",onSelect:function(n){switch(n.props.value){case"point":e=U("mooc_discuss:statistics.state.curr_text.point"),t="point_count";break;case"common":e=U("mooc_discuss:statistics.state.curr_text.common"),t="comment_reply_count";break;case"reply":e=U("mooc_discuss:statistics.state.curr_text.reply"),t="comment_point_count";break;case"like":e=U("mooc_discuss:statistics.state.curr_text.like"),t="liked_count";break;case"tolike":e=U("mooc_discuss:statistics.state.curr_text.to_like"),t="to_like_count";break;case"best":e=U("mooc_discuss:statistics.state.curr_text.best"),t="best_point_count";break;case"invalid":e=U("mooc_discuss:statistics.state.curr_text.invalid"),t="invalid_point_count"}a.setState({visible:!1,currText:e,sort_type:t},(function(){a.getData()}))},onVisibleChange:function(e){a.setState({visible:e})},visible:a.state.visible},v.a.createElement("div",null,v.a.createElement("span",null,a.state.currText),v.a.createElement(i.a,{type:"down"}))))},a.state={visible:!1,wordCloudData:[],currText:"\u4e3b\u5e16\u6570",sort_way:"desc",sort_type:"point_count",showWordCloud:!1,channel:null!==(n=e.discussionBasicData.channel)&&void 0!==n?n:""},a}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&I(e,t)}(t,e),n=t,(a=[{key:"componentDidMount",value:function(){this.getData()}},{key:"render",value:function(){var e=this.props.task,t=this.props.match.params,n=t.node_id,a=t.group_id,o=1!=m.a.parse(this.props.location.search).role&&e;return v.a.createElement("div",{className:f()("mobile-discuss-statistics")},v.a.createElement("div",{className:f()("header")},v.a.createElement(k.a,{type:"icon-return_xy",onClick:this.handleGoBack}),v.a.createElement("span",null,U("mooc_discuss:statistics.render.header.span"))),v.a.createElement(r.a,{className:f()("content"),onRefresh:this.handleRefresh},o&&v.a.createElement(w.a,{node_id:n,group_id:a,isSubgroup:2===(null===e||void 0===e?void 0:e.assign_to_type),channel:this.state.channel,onSelectChannel:this.handleSelectChannel}),this.renderMyCount(),this.renderRank(),this.renderTable()))}}])&&H(n.prototype,a),o&&H(n,o),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,a,o}(v.a.Component))||a;t.default=K}}]);